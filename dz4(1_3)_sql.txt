/*
Условие:
Используя JOIN-ы, выполните следующие операции:
1.Вывести всех котиков по магазинам по id (условие соединения shops.id = cats.shops_id)
2.Вывести магазин, в котором продается кот “Мурзик” (попробуйте выполнить 2 способами)
3.Вывести магазины, в которых НЕ продаются коты “Мурзик” и “Zuza”

Табличка (после слов “Последнее задание, таблица:”)
*/

/*
CREATE DATABASE IF NOT EXISTS lesson4_DZ;
USE lesson4_DZ;

DROP DATABASE IF EXISTS dz3;
CREATE DATABASE IF NOT EXISTS dz3;
*/

DROP DATABASE IF EXISTS hw3;
CREATE DATABASE IF NOT EXISTS hw3;

USE hw3;

DROP TABLE IF EXISTS shops;
CREATE TABLE shops (
id INT,
shopname VARCHAR (100),
PRIMARY KEY (id)
);

DROP TABLE IF EXISTS cats;
CREATE TABLE cats (
name VARCHAR (100),
id INT,
PRIMARY KEY (id),
shops_id INT,
CONSTRAINT fk_cats_shops_id FOREIGN KEY (shops_id)
REFERENCES shops (id)
);

INSERT INTO shops
VALUES
(1, "Четыре лапы"),
(2, "Мистер Зоо"),
(3, "МурзиЛЛа"),
(4, "Кошки и собаки");

INSERT INTO cats
VALUES
("Murzik",1,1),
("Nemo",2,2),
("Vicont",3,1),
("Zuza",4,3);

SELECT *
FROM cats;


SELECT *
FROM shops;

-- 1.Вывести всех котиков по магазинам по id (условие соединения shops.id = cats.shops_id)
SELECT *
FROM cats c, shops s
WHERE s.id = c.shops_id;

-- 2.Вывести магазин, в котором продается кот “Мурзик” (попробуйте выполнить 2 способами)
SELECT s.*
FROM shops s 
JOIN cats c
ON s.id = c.shops_id
WHERE c.name = "Murzik";

SELECT shopname, dz4.name
FROM shops s
JOIN (SELECT *
FROM cats c
WHERE c.name = "Murzik") AS dz4
ON s.id = dz4.shops_id;

-- 3.Вывести магазины, в которых НЕ продаются коты “Мурзик” и “Zuza”


SELECT shopname
FROM shops s
JOIN (SELECT * 
FROM cats c
WHERE (c.name != "Murzik") AND (c.name != "Zuza")) AS dz4
ON s.id = dz4.shops_id;

